<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Papercut IPTV Player</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    
    <style>
        :root {
            --bg-color: #f0ede5;
            --paper-dark: #d9d4c7;
            --paper-edge: #b5af9a;
            --text-color: #4a4a4a;
            --accent: #d32f2f;
        }

        body { 
            background-color: var(--bg-color); 
            color: var(--text-color); 
            font-family: 'Courier Prime', monospace; 
            margin: 0; 
            display: flex; 
            flex-direction: row; /* Video Kiri, Tombol Kanan */
            height: 100vh; 
            overflow: hidden;
        }

        /* Responsive: Video Atas, Tombol Bawah di HP */
        @media (max-width: 768px) {
            body { flex-direction: column; overflow-y: auto; }
            #main-tv { width: 100% !important; height: auto; padding: 10px; }
            #sidebar { width: 100% !important; height: auto; border-left: none; border-top: 4px dashed var(--paper-edge); }
        }

        /* Area Video (Sisi Kiri) */
        #main-tv { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            padding: 30px;
            box-sizing: border-box;
            background: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
        }

        .video-wrapper {
            background: white;
            padding: 15px;
            border: 1px solid var(--paper-edge);
            box-shadow: 8px 8px 0px var(--paper-dark), 15px 15px 0px rgba(0,0,0,0.05);
            position: relative;
        }

        /* Sidebar (Sisi Kanan) */
        #sidebar { 
            width: 380px; 
            background: var(--paper-dark);
            padding: 20px; 
            display: flex; 
            flex-direction: column;
            border-left: 5px solid var(--paper-edge);
            box-shadow: inset 10px 0 20px rgba(0,0,0,0.1);
        }

        .paper-card {
            background: white;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--paper-edge);
            box-shadow: 5px 5px 0px var(--paper-edge);
            transform: rotate(-1deg);
        }

        /* Selector & Search */
        .input-group {
            display: flex;
            align-items: center;
            background: #fff;
            padding: 5px 10px;
            border: 2px solid var(--text-color);
            margin-bottom: 10px;
        }

        select, input {
            border: none;
            width: 100%;
            padding: 8px;
            font-family: inherit;
            outline: none;
        }

        /* Channel List */
        #channel-list { 
            flex-grow: 1; 
            overflow-y: auto; 
            padding-right: 10px;
        }

        .channel-item { 
            padding: 12px; 
            margin-bottom: 12px; 
            background: white;
            border: 1px solid var(--paper-edge);
            box-shadow: 4px 4px 0px var(--paper-edge);
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
        }

        .channel-item i { margin-right: 10px; color: var(--accent); }

        .channel-item:hover {
            transform: translate(-2px, -2px);
            box-shadow: 7px 7px 0px var(--accent);
        }

        .channel-item.active {
            background: var(--accent);
            color: white;
            box-shadow: 2px 2px 0px #000;
        }

        .channel-item.active i { color: white; }

        /* Custom Scrollbar ala Paper */
        #channel-list::-webkit-scrollbar { width: 8px; }
        #channel-list::-webkit-scrollbar-track { background: var(--paper-dark); }
        #channel-list::-webkit-scrollbar-thumb { background: var(--paper-edge); border-radius: 5px; }

        h2, h3 { margin: 0 0 10px 0; text-transform: uppercase; letter-spacing: 2px; }
    </style>
</head>
<body>

<div id="main-tv">
    <div class="paper-card">
        <h3><i class="fas fa-tv"></i> <span id="display-name">Layar Televisi</span></h3>
    </div>
    
    <div class="video-wrapper">
        <video id="my-video" class="video-js vjs-big-play-centered vjs-16-9" controls preload="auto">
            <p class="vjs-no-js">Gunakan browser modern untuk melihat siaran.</p>
        </video>
    </div>
    
    <div style="margin-top: 20px;" class="paper-card">
        <p><i class="fas fa-info-circle"></i> Status: <span id="status-text">Siap Memutar</span></p>
    </div>
</div>

<div id="sidebar">
    <div class="paper-card" style="transform: rotate(1deg);">
        <h3><i class="fas fa-layer-group"></i> PLAYLIST</h3>
        <div class="input-group">
            <i class="fas fa-list"></i>
            <select id="playlist-selector" onchange="changePlaylist(this.value)">
                <option value="https://iptv-org.github.io/iptv/categories/sports.m3u">Sports Pack</option>
                <option value="https://iptv-org.github.io/iptv/categories/movies.m3u">Movie Pack</option>
                </select>
        </div>
        <div class="input-group">
            <i class="fas fa-search"></i>
            <input type="text" id="search-channel" placeholder="Cari saluran..." onkeyup="filterChannels()">
        </div>
    </div>

    <div id="channel-list">
        </div>
</div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
<script>
    const player = videojs('my-video');
    let allChannels = [];

    async function fetchM3U(url) {
        const listContainer = document.getElementById('channel-list');
        listContainer.innerHTML = '<div class="channel-item"><i class="fas fa-sync fa-spin"></i> Memotong Kertas...</div>';
        
        try {
            const response = await fetch(url);
            const data = await response.text();
            parseM3U(data);
        } catch (error) {
            listContainer.innerHTML = '<div class="channel-item"><i class="fas fa-exclamation-triangle"></i> Gagal Memuat.</div>';
        }
    }

    function parseM3U(data) {
        const lines = data.split('\n');
        allChannels = [];
        
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].startsWith('#EXTINF')) {
                const name = lines[i].split(',')[1] || "Channel";
                const url = lines[i + 1]?.trim();
                if (url && url.startsWith('http')) {
                    allChannels.push({ name, url });
                }
            }
        }
        renderChannels(allChannels);
    }

    function renderChannels(channels) {
        const listContainer = document.getElementById('channel-list');
        listContainer.innerHTML = '';
        
        channels.forEach(ch => {
            const div = document.createElement('div');
            div.className = 'channel-item';
            div.innerHTML = `<i class="fas fa-play-circle"></i> ${ch.name}`;
            div.onclick = () => playChannel(ch.url, ch.name, div);
            listContainer.appendChild(div);
        });
    }

    function playChannel(url, name, element) {
        document.getElementById('display-name').innerText = name;
        document.getElementById('status-text').innerText = "Streaming Sekarang...";
        
        document.querySelectorAll('.channel-item').forEach(el => el.classList.remove('active'));
        element.classList.add('active');

        player.src({ type: 'application/x-mpegURL', src: url });
        player.play();

        if (window.innerWidth <= 768) {
            window.scrollTo({top: 0, behavior: 'smooth'});
        }
    }

    function filterChannels() {
        const query = document.getElementById('search-channel').value.toLowerCase();
        const filtered = allChannels.filter(ch => ch.name.toLowerCase().includes(query));
        renderChannels(filtered);
    }

    function changePlaylist(url) {
        fetchM3U(url);
    }

    // Load awal
    fetchM3U(document.getElementById('playlist-selector').value);
</script>

</body>
</html>
